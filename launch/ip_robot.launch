<?xml version="1.0" encoding="UTF-8"?>
<launch>
    <arg name="rvizconfig" default="$(find inverted_pendulum_robot)/rviz/ip_robot.rviz" />
    <arg name="play" default="false"/>

    <include file="$(find gazebo_ros)/launch/empty_world.launch">
        <!-- <arg name="world_name" value="$(find dtw_robot)/worlds/system_class_field"/> -->
        <arg name="paused" value="false"/>
        <arg name="use_sim_time" value="true"/>
        <arg name="gui" value="false"/>
        <arg name="headless" value="false"/>
        <arg name="debug" value="false"/>
    </include>

    <include file="$(find inverted_pendulum_robot)/launch/ip_spawn.launch">
        <!-- <arg name="init_pose" value="-x 1.575 -y 1.125"/> -->
        <arg name="robot_name" value="ip_robot"/>
        <arg name="model" value="$(find inverted_pendulum_robot)/xacro/ip_robot.xacro"/>
    </include>


    <group unless="$(arg play)">
        <arg name="node_start_delay" default="3.0"/>
        <node name="pid_control" pkg="inverted_pendulum_robot" type="pid_control" output="screen" launch-prefix="bash -c 'sleep $(arg node_start_delay); $0 $@' ">
            <!-- <param name="Kp" value="4.8"/> -->
            <param name="Kp" value="4.5"/>
            <param name="Ki" value="5.0"/>
            <param name="Kd" value="0.005"/>
            <param name="init_vel" value="0.01"/>
        </node>
    </group>

    <node name="rviz" pkg="rviz" type="rviz" args="-d $(arg rvizconfig)" required="true" />

</launch>